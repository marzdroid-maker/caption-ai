<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>AI Caption + Hashtag Generator</title>
Â  <style>
Â  Â  :root {
Â  Â  Â  --primary: #3b82f6;
Â  Â  Â  --primary-dark: #2563eb;
Â  Â  Â  --gray: #6b7280;
Â  Â  Â  --light: #f3f4f6;
Â  Â  Â  --border: #e5e7eb;
Â  Â  Â  --placeholder: #9ca3af;
Â  Â  Â  --success: #10b981;
Â  Â  Â  --success-dark: #059669;
Â  Â  Â  --error: #ef4444;
Â  Â  Â  --warning: #f59e0b;
Â  Â  }
Â  Â  * { box-sizing: border-box; margin: 0; padding: 0; }
Â  Â  body {
Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â  Â  Â  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
Â  Â  Â  color: #111;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  padding: 2rem 1rem;
Â  Â  }
Â  Â  .container { max-width: 600px; margin: 0 auto; }
Â  Â  h1 { font-size: 2.25rem; font-weight: 700; text-align: center; margin-bottom: .5rem; }
Â  Â  p.subtitle { text-align: center; color: var(--gray); margin-bottom: 1.5rem; font-size: 1.1rem; }

Â  Â  /* Social Proof */
Â  Â  .proof {
Â  Â  Â  background: #ecfdf5;
Â  Â  Â  border: 1px solid #a7f3d0;
Â  Â  Â  padding: 1rem;
Â  Â  Â  border-radius: .75rem;
Â  Â  Â  text-align: center;
Â  Â  Â  margin-bottom: 1.5rem;
Â  Â  Â  font-size: .95rem;
Â  Â  Â  color: #065f46;
Â  Â  }
Â  Â  .proof strong { font-weight: 600; }

Â  Â  /* Email Modal */
Â  Â  #emailModal {
Â  Â  Â  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  background: rgba(0,0,0,0.7); display: flex; align-items: center;
Â  Â  Â  justify-content: center; z-index: 9999;
Â  Â  }
Â  Â  .modal-content {
Â  Â  Â  background: white; padding: 2rem; border-radius: 1rem;
Â  Â  Â  width: 90%; max-width: 400px; text-align: center;
Â  Â  Â  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
Â  Â  }
Â  Â  .modal-content h2 { margin-bottom: 1rem; font-size: 1.5rem; }
Â  Â  .modal-content p { margin-bottom: 1.5rem; color: #555; }
Â  Â  .modal-content input {
Â  Â  Â  width: 100%; padding: .75rem; border: 2px solid #e5e7eb;
Â  Â  Â  border-radius: .5rem; font-size: 1rem; margin-bottom: 1rem;
Â  Â  }
Â  Â  .modal-content button {
Â  Â  Â  background: var(--primary); color: white; border: none;
Â  Â  Â  padding: .75rem 1.5rem; border-radius: .5rem; font-weight: 600;
Â  Â  Â  cursor: pointer; width: 100%;
Â  Â  }

Â  Â  /* Form */
Â  Â  label { display: block; margin-bottom: .5rem; font-weight: 600; color: #111; }
Â  Â  input, select {
Â  Â  Â  width: 100%; padding: .75rem 1rem; border: 2px solid var(--border);
Â  Â  Â  border-radius: .5rem; font-size: 1rem; margin-bottom: 1rem;
Â  Â  Â  transition: border .2s;
Â  Â  }
Â  Â  input:focus, select:focus { outline: none; border-color: var(--primary); }
Â  Â  input::placeholder { color: var(--placeholder); font-style: italic; }

Â  Â  /* Dropdown placeholder */
Â  Â  select option[disabled] { display: none; }
Â  Â  select option[data-placeholder] { color: var(--placeholder); font-style: italic; }
Â  Â  select:invalid { color: var(--placeholder); }
Â  Â  select:valid { color: #111; }

Â  Â  button {
Â  Â  Â  width: 100%; background: var(--primary); color: white; border: none;
Â  Â  Â  padding: 1rem; font-size: 1.1rem; font-weight: 600; border-radius: .5rem;
Â  Â  Â  cursor: pointer; transition: background .2s;
Â  Â  }
Â  Â  button:hover { background: var(--primary-dark); }
Â  Â  button:disabled { background: #93c5fd; cursor: not-allowed; }

Â  Â  /* Emoji Picker Button */
Â  Â  #emojiPickerBtn {
Â  Â  Â  background: var(--warning); margin: 1rem 0; width: auto; padding: .5rem 1rem; font-size: .9rem;
Â  Â  }

Â  Â  /* Emoji Picker Popup */
Â  Â  #emojiPicker {
Â  Â  Â  display: none; position: absolute; background: white; border: 1px solid #e5e7eb;
Â  Â  Â  border-radius: .75rem; padding: 1rem; max-width: 300px; box-shadow: 0 10px 25px rgba(0,0,0,0.15);
Â  Â  Â  z-index: 100; text-align: center;
Â  Â  }
Â  Â  #emojiGrid {
Â  Â  Â  display: grid; grid-template-columns: repeat(6, 1fr); gap: .5rem; font-size: 1.5rem;
Â  Â  Â  margin: .75rem 0;
Â  Â  }
Â  Â  #emojiGrid button {
Â  Â  Â  background: none; border: none; font-size: 1.5rem; cursor: pointer; padding: 0;
Â  Â  }
Â  Â  #closePicker {
Â  Â  Â  margin-top: .5rem; background: #6b7280; color: white; padding: .5rem 1rem;
Â  Â  Â  border-radius: .5rem; font-size: .8rem; width: auto;
Â  Â  }

Â  Â  .result {
Â  Â  Â  margin-top: 2rem; padding: 1.5rem; background: white; border-radius: .75rem;
Â  Â  Â  box-shadow: 0 4px 12px rgba(0,0,0,.05); position: relative;
Â  Â  }
Â  Â  .result h3 { margin-bottom: .75rem; color: var(--primary); }
Â  Â  .result pre {
Â  Â  Â  white-space: pre-wrap; font-family: inherit; line-height: 1.6; margin-bottom: 1rem;
Â  Â  }
Â  Â  #copyBtn {
Â  Â  Â  position: absolute; top: 1rem; right: 1rem; background: var(--success);
Â  Â  Â  color: white; padding: .5rem 1rem; border: none; border-radius: .5rem;
Â  Â  Â  font-size: .9rem; cursor: pointer; transition: background .2s;
Â  Â  }
Â  Â  #copyBtn:hover { background: var(--success-dark); }
Â  Â  #copyBtn.copied { background: #059669; }

Â  Â  /* History */
Â  Â  #history { margin-top: 1rem; }
Â  Â  #clearHistory { background: #ef4444; margin-top: 1rem; }

Â  Â  /* Pro Templates */
Â  Â  #proTemplates {
Â  Â  Â  margin-top: 2rem; padding: 1.5rem; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: .75rem;
Â  Â  }
Â  Â  .templateBtn {
Â  Â  Â  text-align: left; padding: .75rem; background: white; border: 1px solid #d1d5db;
Â  Â  Â  border-radius: .5rem; font-size: .9rem; margin-bottom: .5rem; cursor: pointer;
Â  Â  }
Â  Â  .templateBtn:hover { background: #f9fafb; }

Â  Â  .paywall {
Â  Â  Â  margin-top: 2rem; padding: 2rem; background: #fefce8; border-radius: .75rem;
Â  Â  Â  text-align: center; border: 2px solid #fde68a;
Â  Â  }
Â  Â  .paywall h3 { margin-bottom: .5rem; font-size: 1.5rem; }
Â  Â  .paywall p { color: #92400e; margin-bottom: 1rem; }
Â  Â  .paywall button {
Â  Â  Â  background: #16a34a; padding: .75rem 1.5rem; font-size: 1rem;
Â  Â  Â  width: auto; display: inline-block;
Â  Â  }
Â  Â  .paywall button:hover { background: #15803d; }

Â  Â  .hidden { display: none; }
Â  Â  .loading { text-align: center; margin: 1rem 0; color: var(--gray); font-style: italic; }

Â  Â  footer {
Â  Â  Â  margin-top: 3rem; text-align: center; color: #6b7280; font-size: 0.875rem;
Â  Â  }
Â  Â  footer a { color: inherit; margin: 0 1rem; text-decoration: underline; }

Â  Â  @media (max-width: 480px) {
Â  Â  Â  h1 { font-size: 1.75rem; }
Â  Â  Â  .container { padding: 0 1rem; }
Â  Â  Â  #copyBtn { position: static; margin-top: 1rem; width: 100%; }
Â  Â  Â  #emojiGrid { grid-template-columns: repeat(5, 1fr); }
Â  Â  }
Â  </style>
</head>
<body>

Â  Â  <div id="emailModal">
Â  Â  <div class="modal-content">
Â  Â  Â  <h2>Welcome!</h2>
Â  Â  Â  <p>Enter your email to get <strong>3 free generations</strong>.</p>
Â  Â  Â  <input type="email" id="emailInput" placeholder="you@example.com" required />
Â  Â  Â  <button id="emailSubmit">Start Generating</button>
Â  Â  </div>
Â  </div>

Â  Â  <div class="container" id="mainApp" style="display: none;">
Â  Â  <h1>AI Caption + Hashtag Generator</h1>
Â  Â  <p class="subtitle">Get 5 viral captions + 30 hashtags in 3 seconds.</p>

Â  Â  <div class="proof">
Â  Â  Â  <strong>Trusted by 50+ creators, solopreneurs, and small businesses</strong>
Â  Â  </div>

Â  Â  <form id="captionForm">
Â  Â  Â  <label for="idea">Post Idea</label>
Â  Â  Â  <input type="text" id="idea" placeholder="e.g. Just launched my coffee shop" required />

Â  Â  Â  <label for="platform">Platform</label>
Â  Â  Â  <select id="platform" required>
Â  Â  Â  Â  <option value="" disabled selected data-placeholder>Choose platform</option>
Â  Â  Â  Â  <option value="Instagram">Instagram</option>
Â  Â  Â  Â  <option value="Twitter">Twitter</option>
Â  Â  Â  Â  <option value="LinkedIn">LinkedIn</option>
Â  Â  Â  Â  <option value="TikTok">TikTok</option>
Â  Â  Â  </select>

Â  Â  Â  <label for="tone">Tone</label>
Â  Â  Â  <select id="tone" required>
Â  Â  Â  Â  <option value="" disabled selected data-placeholder>Choose tone</option>
Â  Â  Â  Â  <option value="Professional">Professional</option>
Â  Â  Â  Â  <option value="Fun & Playful">Fun & Playful</option>
Â  Â  Â  Â  <option value="Inspirational">Inspirational</option>
Â  Â  Â  Â  <option value="Bold & Confident">Bold & Confident</option>
Â  Â  Â  Â  <option value="Casual & Friendly">Casual & Friendly</option>
Â  Â  Â  </select>

Â  Â  Â  <div style="position: relative; text-align: center;">
Â  Â  Â  Â  <button type="button" id="emojiPickerBtn">Add Emojis</button>
Â  Â  Â  Â  <div id="emojiPicker">
Â  Â  Â  Â  Â  <p style="margin-bottom: .75rem; font-weight: 600;">Pick Emojis</p>
Â  Â  Â  Â  Â  <div id="emojiGrid"></div>
Â  Â  Â  Â  Â  <button id="closePicker">Close</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <button type="submit" id="generateBtn">Generate Captions</button>
Â  Â  </form>

Â  Â  <div id="loading" class="loading hidden">Generating magic...</div>

Â  Â  <div id="result" class="result hidden">
Â  Â  Â  <h3>Your AI Captions</h3>
Â  Â  Â  <pre id="output"></pre>
Â  Â  Â  <button type="button" id="copyBtn">Copy All</button>
Â  Â  </div>

Â  Â  Â  Â  <div id="history" class="result hidden">
Â  Â  Â  <h3>Saved Captions</h3>
Â  Â  Â  <div id="historyList" style="font-size: 0.9rem; line-height: 1.6;"></div>
Â  Â  Â  <button id="clearHistory">Clear All</button>
Â  Â  </div>

Â  Â  Â  Â  <div id="proTemplates" class="hidden">
Â  Â  Â  <h3>Pro Templates (Click to Use)</h3>
Â  Â  Â  <div style="display: grid; gap: .5rem; font-size: .9rem;">
Â  Â  Â  Â  <button class="templateBtn">"Just hit 10K followers! Grateful for every one of you Heart"</button>
Â  Â  Â  Â  <button class="templateBtn">"Behind the scenes of [your idea] Camera Film"</button>
Â  Â  Â  Â  <button class="templateBtn">"Tag a friend who needs this! Hand Point Down"</button>
Â  Â  Â  Â  <button class="templateBtn">"New drop alert! Link in bio Shopping Bag"</button>
Â  Â  Â  Â  <button class="templateBtn">"Your daily dose of [topic] Coffee Mug"</button>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="paywall" class="paywall hidden">
Â  Â  Â  <h3>Upgrade to Pro!</h3>
Â  Â  Â  <p>Unlimited generations + <strong>Save History + Pro Templates</strong> for <strong>$7/month</strong>.</p>
Â  Â  Â  <button id="subscribeBtn">Subscribe Now</button>
Â  Â  Â  </div>

Â  Â  <footer>
Â  Â  Â  <a href="/terms.html">Terms</a>
Â  Â  Â  <a href="/privacy.html">Privacy</a>
Â  Â  Â  <span>Â© 2025 Caption AI</span>
Â  Â  </footer>
Â  </div>

Â  <script>
Â  Â  const API_URL = 'https://caption-ai-ze13.onrender.com';
Â  Â  const modal = document.getElementById('emailModal');
Â  Â  const mainApp = document.getElementById('mainApp');
Â  Â  const emailInput = document.getElementById('emailInput');
Â  Â  const emailSubmit = document.getElementById('emailSubmit');

Â  Â  let userEmail = localStorage.getItem('userEmail');

Â  Â  // === EMOJI MAPPING (FIX for empty picker) ===
Â  Â  const emojiMap = {
Â  Â  Â  'Camera': 'ðŸ“¸', 'Heart': 'â¤ï¸', 'Sparkles': 'âœ¨', 'Coffee': 'â˜•', 'Shopping Bag': 'ðŸ›ï¸',
Â  Â  Â  'Rocket': 'ðŸš€', 'Fire': 'ðŸ”¥', 'Trophy': 'ðŸ†', 'Briefcase': 'ðŸ’¼', 'Handshake': 'ðŸ¤',
Â  Â  Â  'Laptop': 'ðŸ’»', 'Sunrise': 'ðŸŒ…', 'Moon': 'ðŸŒ™', 'Pizza': 'ðŸ•', 'Leaf': 'ðŸƒ',
Â  Â  Â  'Flexed Biceps': 'ðŸ’ª', 'Airplane': 'âœˆï¸', 'Book': 'ðŸ“š', 'Dog': 'ðŸ¶', 'Cat': 'ðŸ±',
Â  Â  Â  'Birthday Cake': 'ðŸŽ‚', 'Party Popper': 'ðŸŽ‰', 'Star': 'â­', 'Film': 'ðŸŽ¬',
Â  Â  Â  'Musical Notes': 'ðŸŽ¶', 'Dancer': 'ðŸ’ƒ', 'Play Button': 'â–¶ï¸', 'New': 'ðŸ†•', 'Sale': 'ðŸ·ï¸',
Â  Â  Â  'Check Mark': 'âœ…', 'Cross Mark': 'âŒ', 'Hand Point Down': 'ðŸ‘‡', 'Coffee Mug': 'â˜•' 
Â  Â  };
Â  Â  // Use all keys for the picker, excluding the Coffee Mug placeholder that was only for templates
Â  Â  const commonEmojis = Object.keys(emojiMap).filter(name => name !== 'Coffee Mug'); 

Â  Â  // === EMAIL MODAL ===
Â  Â  if (!userEmail) {
Â  Â  Â  emailSubmit.addEventListener('click', () => {
Â  Â  Â  Â  const email = emailInput.value.trim();
Â  Â  Â  Â  if (email && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
Â  Â  Â  Â  Â  localStorage.setItem('userEmail', email);
Â  Â  Â  Â  Â  modal.style.display = 'none';
Â  Â  Â  Â  Â  mainApp.style.display = 'block';
Â  Â  Â  Â  Â  userEmail = email;
Â  Â  Â  Â  Â  initApp();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  emailInput.style.borderColor = '#ef4444';
Â  Â  Â  Â  Â  emailInput.focus();
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  } else {
Â  Â  Â  modal.style.display = 'none';
Â  Â  Â  mainApp.style.display = 'block';
Â  Â  Â  initApp();
Â  Â  }

Â  Â  function initApp() {
Â  Â  Â  const form = document.getElementById('captionForm');
Â  Â  Â  const generateBtn = document.getElementById('generateBtn');
Â  Â  Â  const loading = document.getElementById('loading');
Â  Â  Â  const result = document.getElementById('result');
Â  Â  Â  const output = document.getElementById('output');
Â  Â  Â  const paywall = document.getElementById('paywall');
Â  Â  Â  const subscribeBtn = document.getElementById('subscribeBtn');
Â  Â  Â  const copyBtn = document.getElementById('copyBtn');

Â  Â  Â  let debounceTimer;
Â  Â  Â  let isGenerating = false;

Â  Â  Â  // === REAL EMOJI PICKER (FIXED) ===
Â  Â  Â  const emojiBtn = document.getElementById('emojiPickerBtn');
Â  Â  Â  const picker = document.getElementById('emojiPicker');
Â  Â  Â  const grid = document.getElementById('emojiGrid');
Â  Â  Â  const closePicker = document.getElementById('closePicker');

Â  Â  Â  grid.innerHTML = ''; // Clear the grid before adding new buttons

Â  Â  Â  commonEmojis.forEach(name => {
Â  Â  Â  Â  const emoji = emojiMap[name]; // Get the actual character
Â  Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  Â  btn.textContent = emoji; // Set to the actual emoji character
Â  Â  Â  Â  btn.style.background = 'none';
Â  Â  Â  Â  btn.style.border = 'none';
Â  Â  Â  Â  btn.style.fontSize = '1.5rem';
Â  Â  Â  Â  btn.style.cursor = 'pointer';
Â  Â  Â  Â  btn.style.padding = '0';
Â  Â  Â  Â  btn.title = name; // Use the name for the tooltip
Â  Â  Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  Â  Â  const idea = document.getElementById('idea');
Â  Â  Â  Â  Â  idea.value = idea.value.trim() + ' ' + emoji;
Â  Â  Â  Â  Â  idea.focus();
Â  Â  Â  Â  });
Â  Â  Â  Â  grid.appendChild(btn);
Â  Â  Â  });

Â  Â  Â  emojiBtn.addEventListener('click', (e) => {
Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  picker.style.display = 'block';
Â  Â  Â  Â  const rect = emojiBtn.getBoundingClientRect();
Â  Â  Â  Â  picker.style.left = `${rect.left}px`;
Â  Â  Â  Â  picker.style.top = `${rect.bottom + 5}px`;
Â  Â  Â  });

Â  Â  Â  closePicker.addEventListener('click', () => {
Â  Â  Â  Â  picker.style.display = 'none';
Â  Â  Â  });

Â  Â  Â  document.addEventListener('click', (e) => {
Â  Â  Â  Â  if (!picker.contains(e.target) && e.target !== emojiBtn) {
Â  Â  Â  Â  Â  picker.style.display = 'none';
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  // Mobile: Use native emoji keyboard
Â  Â  Â  if (/Mobi|Android/i.test(navigator.userAgent)) {
Â  Â  Â  Â  emojiBtn.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  const idea = document.getElementById('idea');
Â  Â  Â  Â  Â  idea.focus();
Â  Â  Â  Â  Â  alert('Tap the emoji key on your keyboard!');
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  // === LIVE GENERATION ===
Â  Â  Â  const inputs = ['idea', 'platform', 'tone'];
Â  Â  Â  inputs.forEach(id => {
Â  Â  Â  Â  document.getElementById(id).addEventListener('input', () => {
Â  Â  Â  Â  Â  clearTimeout(debounceTimer);
Â  Â  Â  Â  Â  debounceTimer = setTimeout(tryGenerate, 800);
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  form.addEventListener('submit', (e) => {
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  clearTimeout(debounceTimer);
Â  Â  Â  Â  tryGenerate(true);
Â  Â  Â  });

Â  Â  Â  async function tryGenerate(forceFull = false) {
Â  Â  Â  Â  if (isGenerating || !userEmail) return;

Â  Â  Â  Â  const idea = document.getElementById('idea').value.trim();
Â  Â  Â  Â  const platform = document.getElementById('platform').value;
Â  Â  Â  Â  const tone = document.getElementById('tone').value;

Â  Â  Â  Â  if (!idea || !platform || !tone) {
Â  Â  Â  Â  Â  result.classList.add('hidden');
Â  Â  Â  Â  Â  paywall.classList.add('hidden');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  isGenerating = true;
Â  Â  Â  Â  loading.classList.remove('hidden');
Â  Â  Â  Â  result.classList.add('hidden');
Â  Â  Â  Â  paywall.classList.add('hidden');
Â  Â  Â  Â  generateBtn.disabled = true;
Â  Â  Â  Â  generateBtn.textContent = 'Generating...';

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/generate`, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({ idea, platform, tone, email: userEmail })
Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  const data = await res.json();

Â  Â  Â  Â  Â  if (res.status === 402) {
Â  Â  Â  Â  Â  Â  paywall.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  result.classList.add('hidden');
Â  Â  Â  Â  Â  } else if (res.ok) {
Â  Â  Â  Â  Â  Â  output.textContent = data.result;
Â  Â  Â  Â  Â  Â  result.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  paywall.classList.add('hidden');
Â  Â  Â  Â  Â  Â  copyBtn.classList.remove('copied');
Â  Â  Â  Â  Â  Â  copyBtn.textContent = 'Copy All';
Â  Â  Â  Â  Â  Â  saveToHistory(data.result);
Â  Â  Â  Â  Â  Â  renderHistory();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  if (forceFull) {
Â  Â  Â  Â  Â  Â  const fallback = `## Captions\n1. "Just launched my coffee shop! â˜•âœ¨"\n2. "Fresh brews, cozy vibes â˜•â¤ï¸"\n3. "Your new favorite morning spot!"\n4. "Handcrafted with love ðŸƒ"\n5. "Come say hi! ðŸ‘‹"\n\n## Hashtags\n#CoffeeShop #NewBusiness #SmallBiz #CoffeeLovers #LocalCafe #SupportLocal #MorningVibes #CoffeeTime #CafeLife #Entrepreneur #ShopSmall #CoffeeAddict #LatteArt #BrewedFresh #CozyCorner #CoffeeCommunity #SmallBusinessOwner #CoffeeCulture #DailyGrind #CafeVibes #CoffeeBreak #Handcrafted #WomenInBusiness #CoffeeLover #BaristaLife #CoffeeGram #InstaCoffee #CoffeeOfTheDay #CoffeeShopVibes #NewCafe`;
Â  Â  Â  Â  Â  Â  output.textContent = fallback;
Â  Â  Â  Â  Â  Â  result.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  saveToHistory(fallback);
Â  Â  Â  Â  Â  Â  renderHistory();
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } finally {
Â  Â  Â  Â  Â  loading.classList.add('hidden');
Â  Â  Â  Â  Â  generateBtn.disabled = false;
Â  Â  Â  Â  Â  generateBtn.textContent = 'Generate Captions';
Â  Â  Â  Â  Â  isGenerating = false;
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  // === COPY ALL ===
Â  Â  Â  copyBtn.addEventListener('click', () => {
Â  Â  Â  Â  navigator.clipboard.writeText(output.textContent).then(() => {
Â  Â  Â  Â  Â  copyBtn.textContent = 'Copied!';
Â  Â  Â  Â  Â  copyBtn.classList.add('copied');
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  copyBtn.textContent = 'Copy All';
Â  Â  Â  Â  Â  Â  copyBtn.classList.remove('copied');
Â  Â  Â  Â  Â  }, 2000);
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  // === SAVE & HISTORY (FIXED RENDERING) ===
Â  Â  Â  function saveToHistory(text) {
Â  Â  Â  Â  const history = JSON.parse(localStorage.getItem('captionHistory') || '[]');
Â  Â  Â  Â  // Only save if the new text is different from the most recent one
Â  Â  Â  Â  if (history[0] !== text) {
Â  Â  Â  Â  Â  history.unshift(text);
Â  Â  Â  Â  Â  history.splice(20);
Â  Â  Â  Â  Â  localStorage.setItem('captionHistory', JSON.stringify(history));
Â  Â  Â  Â  }
Â  Â  Â  Â  renderHistory();
Â  Â  Â  }

Â  Â  Â  function renderHistory() {
Â  Â  Â  Â  const history = JSON.parse(localStorage.getItem('captionHistory') || '[]');
Â  Â  Â  Â  const list = document.getElementById('historyList');
Â  Â  Â  Â  if (history.length === 0) {
Â  Â  Â  Â  Â  list.innerHTML = '<p style="color:#9ca3af; font-style:italic;">No saved captions yet.</p>';
Â  Â  Â  Â  Â  document.getElementById('history').classList.add('hidden');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  list.innerHTML = history.map((item, i) => `
Â  Â  Â  Â  Â  <div style="border-bottom:1px solid #e5e7eb; padding: .75rem 0; display:flex; justify-content:space-between; align-items:flex-start;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <pre style="flex:1; margin:0; font-size:0.85rem; line-height:1.6; white-space:pre-wrap; word-break:break-word; font-family: inherit;">
Â  Â  Â  Â  Â  Â  Â  ${item}
Â  Â  Â  Â  Â  Â  </pre>
Â  Â  Â  Â  Â  Â  <button onclick="copySingle(${i})" style="margin-left:.5rem; background:#10b981; color:white; border:none; padding:.25rem .5rem; border-radius:.25rem; font-size:.75rem;">Copy</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  document.getElementById('history').classList.remove('hidden');
Â  Â  Â  }

Â  Â  Â  window.copySingle = (i) => {
Â  Â  Â  Â  const history = JSON.parse(localStorage.getItem('captionHistory') || '[]');
Â  Â  Â  Â  navigator.clipboard.writeText(history[i]);
Â  Â  Â  };

Â  Â  Â  document.getElementById('clearHistory').addEventListener('click', () => {
Â  Â  Â  Â  localStorage.removeItem('captionHistory');
Â  Â  Â  Â  renderHistory();
Â  Â  Â  });

Â  Â  Â  // === PRO TEMPLATES (FIXED EMOJI NAMES) ===
Â  Â  Â  document.querySelectorAll('.templateBtn').forEach(btn => {
Â  Â  Â  Â  const originalText = btn.textContent;
Â  Â  Â  Â  
Â  Â  Â  Â  // Replace the text names in the button content with actual emojis for display
Â  Â  Â  Â  let displayText = originalText
Â  Â  Â  Â  Â  .replace('Heart', emojiMap['Heart'])
Â  Â  Â  Â  Â  .replace('Camera Film', emojiMap['Camera'] + emojiMap['Film'])
Â  Â  Â  Â  Â  .replace('Hand Point Down', emojiMap['Hand Point Down'])
Â  Â  Â  Â  Â  .replace('Shopping Bag', emojiMap['Shopping Bag'])
Â  Â  Â  Â  Â  .replace('Coffee Mug', emojiMap['Coffee']);

Â  Â  Â  Â  btn.innerHTML = displayText; // Set the button's display text (with actual emojis)

Â  Â  Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  Â  Â  // Set the input value using the actual emojis
Â  Â  Â  Â  Â  document.getElementById('idea').value = displayText;
Â  Â  Â  Â  Â  document.getElementById('idea').focus();
Â  Â  Â  Â  });
Â  Â  Â  });

Â  Â  Â  // === SUBSCRIBE ===
Â  Â  Â  subscribeBtn.addEventListener('click', async () => {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const res = await fetch(`${API_URL}/create-checkout-session`, {
Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  body: JSON.stringify({ email: userEmail })
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  const { url } = await res.json();
Â  Â  Â  Â  Â  window.location.href = url;
Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  alert('Checkout failed. Please try again.');
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  // Load history on start
Â  Â  Â  renderHistory();
Â  Â  }
Â  </script>
</body>
</html>